# ğŸš€ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸

## ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ ì°¸ì—¬ ì¸ì› 
| <img src="https://avatars.githubusercontent.com/u/83341978?v=4" width="150" height="150"/> | <img src="https://avatars.githubusercontent.com/u/129728196?v=4" width="150" height="150"/> | <img src="https://avatars.githubusercontent.com/u/104816148?v=4" width="150" height="150"/> |
|:-------------------------------------------------------------------------------------------:|:------------------------------------------------------------------------------------------:|:-------------------------------------------------------------------------------------------:|
|                     **ë°•ì§€ì›** <br/>[@jiione](https://github.com/jiione)                     |                      **ìµœë‚˜ì˜**<br/>[@na-rong](https://github.com/na-rong)                      |                     **ë°•í˜„ì„œ**<br/>[@hyleei](https://github.com/hyleei)                        |



## ğŸ“Œ ê°œìš”

Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìš´ì˜í•˜ë©´ì„œ ê³¼ë¶€í•˜ë‚˜ ì§€ë‚˜ì¹œ ìš”ì²­ìœ¼ë¡œ ì¸í•œ ì¥ì• ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ë„êµ¬**ì˜ í•„ìš”ì„±ì„ ëŠê¼ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ê°€ì‹œì„±ì´ ë›°ì–´ë‚œ ëª¨ë‹ˆí„°ë§ íˆ´ì„ ë„ì…í•˜ì—¬ ì‹œìŠ¤í…œ ìƒíƒœë¥¼ í•œëˆˆì— íŒŒì•…í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤. ì´ì „ì— ELK ìŠ¤íƒì„ í™œìš©í•´ Kibanaë¡œ ëŒ€ì‹œë³´ë“œë¥¼ ì‹œê°í™”í•œ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ, ì´ë²ˆì—ëŠ” **Prometheus**ì™€ **Grafana**ë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€ì‹œë³´ë“œë¥¼ êµ¬ì„±í•˜ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤.

ë˜í•œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤ì œë¡œ ì–´ëŠ ì •ë„ì˜ ë¶€í•˜ë¥¼ ê²¬ë”œ ìˆ˜ ìˆëŠ”ì§€ íŒŒì•…í•˜ê¸° ìœ„í•´ **JMeterë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ì–‘í•œ ìš”ì²­ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œë®¬ë ˆì´ì…˜**í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ê³¼ ì„±ëŠ¥ í•œê³„ë¥¼ ê²€ì¦í•˜ê³ , ì ì¬ì ì¸ ë¬¸ì œì ì„ ì‚¬ì „ì— ë°œê²¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

ì´ í”„ë¡œì íŠ¸ëŠ” ì´ëŸ¬í•œ ëª¨ë‹ˆí„°ë§ ë° ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë„êµ¬ë“¤ì„ í†µí•©í•˜ì—¬ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì„ ìµœì í™”í•˜ê³ , ì•ˆì •ì ì¸ ìš´ì˜ í™˜ê²½ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.


## ğŸ¯ ê¸°íš

### í”„ë¡œì íŠ¸ ëª©í‘œ
- Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ë° ëª¨ë‹ˆí„°ë§ í™˜ê²½ êµ¬ì¶•
- ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ë¶„ì„
- ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬í˜„

### í•„ìš” ë„êµ¬
- Java JDK 17
- Spring Boot 3.3.4
- Apache JMeter 5.6.3
- Prometheus 2.30.3
- Grafana 11.2.2

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
- ë™ì‹œ ì‚¬ìš©ì ìˆ˜ ì¦ê°€ì— ë”°ë¥¸ ì‘ë‹µ ì‹œê°„ ì¸¡ì •
- ì¥ì‹œê°„ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•œ ì‹œìŠ¤í…œ ì•ˆì •ì„± í™•ì¸
- CPU, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

## ğŸ›  êµ¬ì„±

### Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •

1. ì˜ì¡´ì„± ì¶”ê°€ (build.gradle):
```gradle
implementation 'org.springframework.boot:spring-boot-starter-actuator'
implementation 'io.micrometer:micrometer-registry-prometheus'
```

2. application.properties ì„¤ì •:
```properties
management.endpoints.web.exposure.include=prometheus
management.endpoint.prometheus.enabled=true
server.port=8080
```

3. ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰:
```bash
java -jar SpringApp-0.0.1-SNAPSHOT.jar
```

### JMeter ì„¤ì •

1. JMeter ì„¤ì¹˜:
```bash
wget https://downloads.apache.org/jmeter/binaries/apache-jmeter-5.6.3.tgz
tar -xzf apache-jmeter-5.6.3.tgz
```

2. í…ŒìŠ¤íŠ¸ ê³„íš (test_plan.jmx) ìƒì„±:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0" jmeter="5.5">
  <hashTree>
    <TestPlan guiclass="TestPlanGui" testclass="TestPlan" testname="Spring Boot App Stress Test Plan" enabled="true">
      <stringProp name="TestPlan.comments"></stringProp>
      <boolProp name="TestPlan.functional_mode">false</boolProp>
      <boolProp name="TestPlan.tearDown_on_shutdown">true</boolProp>
      <boolProp name="TestPlan.serialize_threadgroups">false</boolProp>
      <elementProp name="TestPlan.user_defined_variables" elementType="Arguments" guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="true">
        <collectionProp name="Arguments.arguments"/>
      </elementProp>
      <stringProp name="TestPlan.user_define_classpath"></stringProp>
    </TestPlan>
    <hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="Stress Test Thread Group" enabled="true">
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller" enabled="true">
          <boolProp name="LoopController.continue_forever">false</boolProp>
          <stringProp name="LoopController.loops">100</stringProp>
        </elementProp>
        <stringProp name="ThreadGroup.num_threads">500</stringProp>
        <stringProp name="ThreadGroup.ramp_time">60</stringProp>
        <boolProp name="ThreadGroup.scheduler">false</boolProp>
        <stringProp name="ThreadGroup.duration"></stringProp>
        <stringProp name="ThreadGroup.delay"></stringProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
      </ThreadGroup>
      <hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="HTTP Request" enabled="true">
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="true">
            <collectionProp name="Arguments.arguments"/>
          </elementProp>
          <stringProp name="HTTPSampler.domain">localhost</stringProp>
          <stringProp name="HTTPSampler.port">8080</stringProp>
          <stringProp name="HTTPSampler.protocol">http</stringProp>
          <stringProp name="HTTPSampler.contentEncoding"></stringProp>
          <stringProp name="HTTPSampler.path">/test</stringProp>
          <stringProp name="HTTPSampler.method">GET</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <boolProp name="HTTPSampler.auto_redirects">false</boolProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.DO_MULTIPART_POST">false</boolProp>
          <stringProp name="HTTPSampler.embedded_url_re"></stringProp>
          <stringProp name="HTTPSampler.connect_timeout"></stringProp>
          <stringProp name="HTTPSampler.response_timeout"></stringProp>
        </HTTPSamplerProxy>
        <hashTree/>
      </hashTree>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
```

### Prometheus ì„¤ì •

1. Prometheus ì„¤ì¹˜:
```bash
wget https://github.com/prometheus/prometheus/releases/download/v2.30.3/prometheus-2.30.3.linux-amd64.tar.gz
tar xvfz prometheus-*.tar.gz
```

2. prometheus.yml ì„¤ì •:
```yaml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'spring_boot_app'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['localhost:8080']
```

3. Prometheus ì‹¤í–‰:
```bash
./prometheus --config.file=prometheus.yml
```

### Grafana ì„¤ì •

1. Grafana ì„¤ì¹˜:
```bash
sudo apt-get install -y software-properties-common
sudo add-apt-repository "deb https://packages.grafana.com/oss/deb stable main"
wget -q -O - https://packages.grafana.com/gpg.key | sudo apt-key add -
sudo apt-get update
sudo apt-get install grafana
```

2. Grafana ì„œë¹„ìŠ¤ ì‹œì‘:
```bash
sudo systemctl start grafana-server
sudo systemctl enable grafana-server
```

3. Grafana ëŒ€ì‹œë³´ë“œ ì„¤ì •:
   - Prometheus ë°ì´í„° ì†ŒìŠ¤ ì¶”ê°€
   - ëŒ€ì‹œë³´ë“œ ìƒì„± (ìš”ì²­ ì²˜ë¦¬ëŸ‰, ì‘ë‹µ ì‹œê°„, CPU ì‚¬ìš©ëŸ‰, JVM ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë“±)

## ğŸ§ª í…ŒìŠ¤íŠ¸

### JMeter ê³¼ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

1. í…ŒìŠ¤íŠ¸ ê³„íš ìˆ˜ì • (test_plan.jmx):
   - Thread Group ì„¤ì •:
     - Number of Threads (users): 500
     - Ramp-up period (seconds): 60
     - Loop Count: 100

2. ê³¼ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰:
```bash
jmeter -n -t test_plan.jmx -l results.jtl
```

3. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§:
   - Grafana ëŒ€ì‹œë³´ë“œì—ì„œ ë‹¤ìŒ ë©”íŠ¸ë¦­ ê´€ì°°:
     - ìš”ì²­ ì²˜ë¦¬ëŸ‰ (Throughput):
       ```
       rate(http_server_requests_seconds_count{job="spring_boot_app"}[1m])
       ```
     - CPU ì‚¬ìš©ëŸ‰:
       ```
       system_cpu_usage{job="spring_boot_app"}
       ```
     - JVM ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰:
       ```
       sum(jvm_memory_used_bytes{job="spring_boot_app"}) by (area)
       ```

## ğŸ“Š ê²€ì¦

### JMeter ê²°ê³¼ ë¶„ì„

```bash
jmeter -g results.jtl -o html_report
```
![image](https://github.com/user-attachments/assets/66b43697-5ae9-4e5d-b6c2-ec9f56443b0a)

### Prometheus ë°ì´í„° í™•ì¸
ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ `http://your_server_ip:9090` ì ‘ì†

![image](https://github.com/user-attachments/assets/4e0f942d-9f69-478f-8fb0-ac2acab0036c)

### Grafana ëŒ€ì‹œë³´ë“œ ë¶„ì„
- ìš”ì²­ ì²˜ë¦¬ëŸ‰, ì‘ë‹µ ì‹œê°„, ì˜¤ë¥˜ìœ¨ í™•ì¸
- CPU, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¶”ì´ ë¶„ì„
- ë³‘ëª© ì§€ì  ì‹ë³„ ë° ì„±ëŠ¥ ê°œì„  í¬ì¸íŠ¸ ë„ì¶œ

![image](https://github.com/user-attachments/assets/543742b1-a784-4fa5-aac8-bfa0ec988246)



## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

1. Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ í¬íŠ¸ ë¬¸ì œ
   - ë¬¸ì œ: ì• í”Œë¦¬ì¼€ì´ì…˜ì´ 8999 í¬íŠ¸ì—ì„œ ì‹¤í–‰ë˜ì–´ ì ‘ê·¼ ë¶ˆê°€
   - í•´ê²°: `application.properties`ì—ì„œ `server.port=8080`ìœ¼ë¡œ ì„¤ì •

2. Prometheus íƒ€ê²Ÿ ì ‘ê·¼ ë¬¸ì œ
   - ë¬¸ì œ: Prometheusê°€ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”íŠ¸ë¦­ì— ì ‘ê·¼ ë¶ˆê°€
   - í•´ê²°: Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ Actuator ì„¤ì • í™•ì¸ ë° ìˆ˜ì •

3. Grafana ë°ì´í„° ì†ŒìŠ¤ ì—°ê²° ë¬¸ì œ
   - ë¬¸ì œ: Grafanaì—ì„œ Prometheus ë°ì´í„° ì†ŒìŠ¤ ì—°ê²° ì‹¤íŒ¨
   - í•´ê²°: Prometheus URL ë° ì ‘ê·¼ ì„¤ì • í™•ì¸

4. JMeter ì‹¤í–‰ ì‹œ XStream ë³´ì•ˆ ì˜ˆì™¸
   - ë¬¸ì œ: JMeter ì‹¤í–‰ ì‹œ XStream ê´€ë ¨ ë³´ì•ˆ ì˜ˆì™¸ ë°œìƒ
   - í•´ê²°: JMeterì˜ `user.properties` íŒŒì¼ì— `jmeter.save.saveservice.allowlist=*` ì¶”ê°€

5. ê³¼ë„í•œ ë¶€í•˜ë¡œ ì¸í•œ ì‹œìŠ¤í…œ ë¶ˆì•ˆì •
   - ë¬¸ì œ: ë†’ì€ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì¤‘ ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ê³ ê°ˆ
   - í•´ê²°: í…ŒìŠ¤íŠ¸ ê³„íšì˜ ìŠ¤ë ˆë“œ ìˆ˜ì™€ ë°˜ë³µ íšŸìˆ˜ ì¡°ì •, ì„œë²„ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ ê°•í™”

## ğŸ ê²°ë¡ 

ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ **ì„±ëŠ¥ ìµœì í™”**ì— ìˆì–´ **ë¶€í•˜ í…ŒìŠ¤íŠ¸ì™€ ëª¨ë‹ˆí„°ë§**ì˜ ì¤‘ìš”ì„±ì„ ì¬í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤. JMeterë¡œ ì‹¤ì œ ì‚¬ìš© í™˜ê²½ê³¼ ìœ ì‚¬í•œ ë¶€í•˜ë¥¼ ìƒì„±í•¨ìœ¼ë¡œì¨ ì ì¬ì ì¸ ë¬¸ì œì ì„ ë°œê²¬í•  ìˆ˜ ìˆì—ˆê³ , Prometheusì™€ Grafanaë¥¼ í†µí•´ ìˆ˜ì§‘ëœ ë°ì´í„°ë¡œ ëª…í™•í•œ ê°œì„  ë°©í–¥ì„ ì„¤ì •í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê³¼ì •ì€ **ì•ˆì •ì ì´ê³  íš¨ìœ¨ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ìš´ì˜**ì„ ìœ„í•œ ì¤‘ìš”í•œ ê¸°ë°˜ì´ ë  ê²ƒì…ë‹ˆë‹¤.

